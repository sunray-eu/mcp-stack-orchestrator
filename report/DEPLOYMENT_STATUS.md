# Deployment Status

Date: 2026-02-20

## Applied Profile
- `full` (managed stack)

## Managed MCP Profile (Global Dynamic)
- Active managed MCP names:
  - `mcpx-basic-memory`
  - `mcpx-qdrant`
  - `mcpx-chroma`
  - `mcpx-lsp`
  - `mcpx-surrealdb-http`
  - `mcpx-archon-http`
- Dynamic behavior:
  - `mcpx-qdrant` derives collection by workspace (`proj-<repo-slug>`) by default.
  - `mcpx-lsp` derives workspace from current directory and auto-selects Python vs TypeScript language server.
- Validation:
  - Dynamic qdrant runs succeeded from both repos and created distinct collections:
    - `proj-ts-repo`
    - `proj-py-repo`
- Optional per-repo overrides:
  - `.mcp-stack.env` in repo root
  - Template: `<STACK_ROOT>/configs/mcp-stack.env.example`

## Runtime Containers (canonical naming)
- `ai-mcp-qdrant`
- `ai-mcp-surreal-mcp`
- `ai-mcp-surrealdb`
- `ai-mcp-surrealist`
- `ai-mcp-archon-server`
- `ai-mcp-archon-mcp`
- `ai-mcp-archon-ui`
- `ai-mcp-docs-mcp`

## Runtime Endpoints
- Qdrant API: `http://127.0.0.1:6333/healthz`
- Qdrant Dashboard: `http://127.0.0.1:6333/dashboard/`
- Surreal MCP: `http://127.0.0.1:18080/mcp`
- SurrealDB RPC: `http://127.0.0.1:18083/rpc`
- Surrealist UI: `http://127.0.0.1:18082`
- Archon MCP: `http://127.0.0.1:18051/mcp`
- Archon API Health: `http://127.0.0.1:18081/health`
- Archon MCP Health: `http://127.0.0.1:18051/health`
- Archon UI: `http://127.0.0.1:13737`
- Docs MCP UI: `http://127.0.0.1:16280`

Health checks:
- Qdrant API status: `200`
- Qdrant Dashboard status: `200`
- Archon health HTTP status: `200`
- Archon UI status: `200`
- Surreal MCP probe status: `406` (expected for plain HTTP probe against MCP streamable endpoint)
- SurrealDB RPC probe status: `400` (expected for non-upgrade/non-RPC probe; confirms endpoint is reachable)
- Surrealist UI status: `200`
- Docs MCP UI status: `200`
- Docs MCP `/mcp` probe status: `405` (endpoint exists; GET probe is not allowed)

## Surrealist Managed Connection
- Managed connection config runtime file: `<STACK_ROOT>/tmp/surrealist-instance.json`
- Generated by `<STACK_ROOT>/scripts/stack_infra.sh` from `<STACK_ROOT>/.secrets.env` (or safe defaults), then mounted into Surrealist web root as `/instance.json`.
- Preloaded connection details:
  - Connection name: `Local SurrealDB (Docker)`
  - Protocol/host: `ws://127.0.0.1:18083`
  - Auth mode: `root` (`root`/`root`, local dev only)
  - Default namespace/database: `mcp` / `workspace`
- Validation performed:
  - Surrealist overview shows built-in connection entry.
  - Opening the entry lands on query screen with namespace/database selected.
  - Query execution succeeded (`CREATE verification:test ...; SELECT * FROM verification:test;`).
  - Direct API validation succeeded via `POST /sql` with `Surreal-NS`/`Surreal-DB` headers and bearer token.

## Docs MCP Embeddings Status
- Source of credentials: `<STACK_ROOT>/.secrets.env` via generated runtime file `<STACK_ROOT>/tmp/ai-mcp-infra.env`
- Effective embedding model: `openai:text-embedding-3-small`
- Startup verification from container logs: `Embeddings: openai:text-embedding-3-small`
- Disabled warning check: no `Vector search is disabled` warning present after reconfiguration
- MCP protocol verification:
  - `POST /mcp` `initialize` returned `200` with server capabilities
  - `tools/list` returned tool catalog successfully
  - `scrape_docs` + `search_docs` flow completed (local test library), then cleaned up with `remove_docs`

## Versioning / Upgrades
- Managed image matrix: `<STACK_ROOT>/infra/versions.env`
- Version commands:
  - `<STACK_ROOT>/scripts/stack_versions.sh show`
  - `<STACK_ROOT>/scripts/stack_versions.sh check`
  - `<STACK_ROOT>/scripts/stack_versions.sh refresh`
- Post-upgrade verification:
  - `<STACK_ROOT>/scripts/stack_doctor.sh full`

## Docker MCP Filesystem Access
- Mount policy: read-only host filesystem access for MCP containers.
- Effective mounts:
  - `/` -> `/hostfs`
  - `/Users` -> `/Users`
- Verified containers:
  - `ai-mcp-docs-mcp`
  - `ai-mcp-surreal-mcp`
  - `ai-mcp-archon-server`
  - `ai-mcp-archon-mcp`
- Local indexing verification:
  - docs-mcp successfully indexed and searched a local file via `file:///Users/...` path.
  - Test data was removed after validation.

## Supabase Naming
- Project ref: `gydtkaqliotvwasgyubw`
- Project name: `ai-mcp-archon`
- Status: `ACTIVE_HEALTHY`

## MCP Snapshot Artifacts
- `<STACK_ROOT>/report/ui_endpoint_status.tsv`
- `<STACK_ROOT>/report/WEB_UI_AUDIT.md`
